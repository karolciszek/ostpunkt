{% extends 'base.html' %}
{% load static %}
{% load leaflet_tags %}
{% block content %}
    {% leaflet_js %}
    {% leaflet_css %}
    <link href="{% static "last_point_map/css/map.css" %}" rel="stylesheet"/>
    <script>
     // Locations for pointmap.js. Is this good practice to have global vars like this?
     var icon_url = "{% static 'last_point_map/images/marker.svg' %}";
     var submit_url = "{% url 'get_recent_point' %}";
    </script>
    <script src="{% static 'last_point_map/js/pointmap.js' %}"></script>

    <h2>
        Hi there{% if user.is_authenticated %}, {{ user.username }}{% endif %}!
        Click <a href="#" id="help-toggle">here</a> to toggle display help{% if user.is_authenticated %}, or <a href="{% url 'auth_logout' %}">here</a> to log out{% endif %}.
    </h2>

    <p id="help">
        Here is a map with the most recently submitted point. Move the marker by dragging it or clicking on the map, and press <strong>'Save point'</strong> at the bottom of the page to submit someplace different!
    </p>

    <p>
        The last point was submitted by <strong>{{ point.author.username }}</strong> at {{ point.set_at_readable }}.
    </p>

    {% leaflet_map "pointmap" %}
    <h3 id="save_pt_button">{% if user.is_authenticated %}<a href="#">Save point</a>{% else %}You are not logged in. Please <a href="{% url 'auth_login' %}">login</a> or <a href="{% url 'registration_register' %}">register</a> to submit points!{% endif %}</h3>
{% endblock %}
