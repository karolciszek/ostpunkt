{% extends 'base.html' %}
{% load static %}
{% load leaflet_tags %}
{% block content %}
    {% leaflet_js %}
    {% leaflet_css %}
    <link href="{% static "last_point_map/css/map.css" %}" rel="stylesheet"/>
    <script>
     // Locations for pointmap.js. Is this good practice to have global vars like this?
     var icon_url = "{% static 'last_point_map/images/marker.svg' %}";
     var submit_url = "{% url 'get_recent_point' %}";
    </script>
    <script src="{% static 'last_point_map/js/pointmap.js' %}"></script>

    <h3>
        Hi there, {% if user.first_name %}{{ user.first_name }}{% else %}{{ user.username }}{% endif %}!
        Click <a href="{% url 'auth_logout' %}">here</a> to log out.
    </h3>

    <p>
        Here is a map with the most recently submitted point. Move the marker (or click to create one) and press <strong>'Save point'</strong> to submit someplace different!
    </p>

    <p>
        The last point was submitted by <strong>{{ point.author.username }}</strong> on {{ point.set_at }}.
    </p>

    {% leaflet_map "pointmap" %}
    <button id="save_pt_button">Save point</button>
{% endblock %}
